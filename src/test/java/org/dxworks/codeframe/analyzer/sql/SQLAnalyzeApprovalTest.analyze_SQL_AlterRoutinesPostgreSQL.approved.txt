{
  "filePath" : "src/test/resources/samples/sql/alter_routines_postgresql.sql",
  "language" : "sql",
  "topLevelReferences" : { },
  "topLevelCalls" : { },
  "alterFunctions" : [ {
    "functionName" : "fn_net_amount",
    "parameters" : [ {
      "name" : "p_gross",
      "type" : "DECIMAL(12,2)"
    }, {
      "name" : "p_tax_rate_id",
      "type" : "INT"
    } ],
    "returnType" : "DECIMAL(12,2)",
    "references" : {
      "relations" : [ "active_discounts_view", "tax_rates" ]
    },
    "calls" : { }
  }, {
    "functionName" : "fn_get_low_stock_items",
    "schema" : "inventory",
    "parameters" : [ {
      "name" : "p_warehouse_id",
      "type" : "INT"
    } ],
    "returnType" : "TABLE(product_id INT,product_name VARCHAR,quantity INT,threshold INT)",
    "references" : {
      "relations" : [ "inventory.stock", "inventory.products", "inventory.reorder_thresholds_view" ]
    },
    "calls" : { }
  } ],
  "alterProcedures" : [ {
    "procedureName" : "recalc_order_total",
    "schema" : "sales",
    "parameters" : [ {
      "name" : "p_order_id",
      "type" : "INT"
    }, {
      "name" : "p_customer_id",
      "type" : "INT"
    } ],
    "references" : {
      "relations" : [ "sales.order_items", "sales.orders", "sales.customer_tax_info_view" ]
    },
    "calls" : {
      "functions" : [ "fn_net_amount", "SUM" ],
      "procedures" : [ "log_order_update" ]
    }
  }, {
    "procedureName" : "process_purchase_order",
    "schema" : "purchasing",
    "parameters" : [ {
      "name" : "p_po_id",
      "type" : "INT"
    } ],
    "references" : {
      "relations" : [ "purchasing.purchase_orders", "purchasing.approved_vendors_view" ]
    },
    "calls" : {
      "functions" : [ "fn_calculate_discount" ],
      "procedures" : [ "update_expected_stock", "accounting.create_payable", "notifications.send_approval_notification" ]
    }
  } ]
}